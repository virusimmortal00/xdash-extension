import{A as T}from"./analyticsHandler.js";const L=["Facebook Ads","SMS","unityads_int","Apple Search Ads","applovin_int","remerge_int","Email","tapjoy_int","adquant","criteo_int","googleadwords_int","ironsource_int","bytedanceglobal_int","reddit_int","twitter_int","snapchat_int","vungle_int","tiktok_int","taboola_int","appguardion_int","blindferret_int","crosstarget_int","Google"],S=["level_5_achieved","tutorial_completed","af_purchase","ad_monetized","level_10_achieved"];function v(e,n=!1){console.log("selectImage called with URL:",e,"Is custom URL:",n);const t=document.getElementById("customImagePreview");if(document.querySelectorAll(".image-option").forEach(o=>{o.style.border="none"}),n&&t)t.innerHTML=`<img src="${e}" class="preview-image">`,t.style.border="2px solid green",t.style.display="block";else{const o=document.querySelector(`.image-option[src="${e}"]`);o&&(o.style.border="2px solid green"),t&&(t.innerHTML="",t.style.display="none")}}const E=document.getElementById("customImagePreview"),p=document.getElementById("customImageUrl");function B(){console.log("Loading or setting default image"),chrome.storage.sync.get(["selectedImage","activePreset"],function(e){console.log("Loaded active preset button:",e.activePreset);const n="icons/af_icon_rainbow.png";let t=e.selectedImage||n;console.log("Selected image:",t),t.startsWith("icons/")?(v(t),p.value="",E.innerHTML="",E.style.display="none"):(p.value=t,v(t,!0)),document.querySelectorAll(".preset-button").forEach(i=>{i.classList.remove("active")});const a=e.activePreset||"button-custom",c=document.getElementById(a);console.log("Active preset button:",c),c&&c.classList.add("active")})}function C(){const e=document.createElement("div");return e.id="unsaved-changes-msg",e.innerText="Unsaved changes - make sure to save.",e}const s=C();function P(){console.log("Save button clicked");const e=[];document.querySelectorAll("#mediaSources .mapping-row, #inAppEvents .mapping-row").forEach(i=>{const l=i.querySelector(".original-text"),d=i.querySelector(".new-text"),h=i.parentElement?i.parentElement.id:"";l&&d&&e.push({section:h,original:l.value,newText:d.value})});let n;const t=document.querySelector('.image-option[style*="border: 2px solid green"]');t?n=t.getAttribute("src")||"https://web1.sa.appsflyer.com/xdash_images/af_icon_rainbow.png":p.value?n=p.value:n="https://web1.sa.appsflyer.com/xdash_images/af_icon_rainbow.png";const o=document.querySelector(".preset-button.active"),a=o?o.value:"",c=g.checked;chrome.storage.sync.set({extensionEnabled:c},()=>{console.log("Extension status saved:",c)}),chrome.storage.sync.set({mappings:e,selectedImage:n,activePreset:a},()=>{console.log("Mappings, selected image, and active preset button state saved:",e,n,a),s.innerText="Changes saved!",s.style.color="green",s.style.display="block",setTimeout(()=>{s.style.display="none"},2e3)})}function w(){s.style.display="block",s.innerText="Unsaved changes - make sure to save!",s.style.color="red"}function k(){document.querySelectorAll(".original-text, .new-text").forEach(e=>{e.removeEventListener("input",w),e.addEventListener("input",w)})}const M={"button-gaming":{iconUrl:"icons/af_icon_red.png",mappings:[{section:"inAppEvents",original:"level_5_achieved",newText:"Purchase"},{section:"inAppEvents",original:"af_purchase",newText:"Level 3 Achieved"},{section:"inAppEvents",original:"level_10_achieved",newText:"Level 10 Achieved"},{section:"inAppEvents",original:"tutorial_completed",newText:"Deposit"},{section:"inAppEvents",original:"ad_monetized",newText:"Log In"}]},"button-ecommerce":{iconUrl:"icons/af_icon_orange.png",mappings:[{section:"inAppEvents",original:"level_5_achieved",newText:"Log-in"},{section:"inAppEvents",original:"af_purchase",newText:"Purchase"},{section:"inAppEvents",original:"level_10_achieved",newText:"Add to Wishlist"},{section:"inAppEvents",original:"tutorial_completed",newText:"First Purchase"},{section:"inAppEvents",original:"ad_monetized",newText:"Loyalty Signup"}]},"button-banking":{iconUrl:"icons/af_icon_green.png",mappings:[{section:"inAppEvents",original:"level_5_achieved",newText:"Application Started"},{section:"inAppEvents",original:"af_purchase",newText:"Application Completed"},{section:"inAppEvents",original:"level_10_achieved",newText:"Application Approved"},{section:"inAppEvents",original:"tutorial_completed",newText:"First Deposit"},{section:"inAppEvents",original:"ad_monetized",newText:"Create Account"}]},"button-general":{iconUrl:"icons/af_icon_rainbow.png",mappings:[{section:"inAppEvents",original:"level_5_achieved",newText:"Create Account"},{section:"inAppEvents",original:"af_purchase",newText:"Add to Cart"},{section:"inAppEvents",original:"level_10_achieved",newText:"Purchase"},{section:"inAppEvents",original:"tutorial_completed",newText:"First Purchase"},{section:"inAppEvents",original:"ad_monetized",newText:"Booking"}]}},y="Unsaved changes - make sure to save!",m="block",_="red",U="2px solid green",q="none",D="none";function A(e,n,t){s.innerText=e,s.style.display=n,s.style.color=t}function O(e,n,t){E.innerHTML=e?`<img src="${e}" class="preview-image">`:"",E.style.border=e?t:q,E.style.display=e?n:D}function f(){const e=document.getElementById("button-custom");e==null||e.click()}function R(){console.log("Setting event listeners");const e=document.getElementById("addMediaSource"),n=document.getElementById("addInAppEvent"),t=document.getElementById("save");e.addEventListener("click",()=>r("mediaSources","","")),n.addEventListener("click",()=>r("inAppEvents","","")),t.addEventListener("click",P),g.addEventListener("change",w),p.addEventListener("input",()=>{const i=p.value||"";v(i,!!i),O(i,m,U),A(y,m,_),f()});function o(i){var h;document.querySelectorAll(".preset-button").forEach(x=>x.classList.remove("active"));const l=i.currentTarget;l.classList.add("active");const d=M[l.id];if(d){d.iconUrl&&v(d.iconUrl);const x=document.getElementById("inAppEvents");x.innerHTML="",(h=d.mappings)==null||h.forEach(b=>r(b.section,b.original,b.newText))}A(y,m,_)}document.querySelectorAll(".preset-button").forEach(i=>i.addEventListener("click",o));const c=document.getElementById("button-custom");c==null||c.classList.add("active"),document.querySelectorAll(".image-option").forEach(i=>{i.addEventListener("click",()=>{const l=i.getAttribute("src")||"";console.log("Predefined image option clicked:",l),v(l),p.value="",A(y,m,_),f()})}),document.querySelectorAll("#mediaSources input, #inAppEvents input").forEach(i=>{i.addEventListener("input",()=>{A(y,m,_),f()})})}function r(e,n,t){console.log("Adding mapping row to",e);const o=document.createElement("div"),a=document.getElementById("mediaSources"),c=document.getElementById("inAppEvents");if(!a||!c){console.error("Required elements not found in the document");return}o.className="mapping-row",o.innerHTML=`
        <input type="text" class="original-text" placeholder="Original" value="${n}">
        <input type="text" class="new-text" placeholder="Replacement" value="${t}">
        <button class="action-button remove-mapping">&#10005;</button>`,o.querySelector(".remove-mapping").addEventListener("click",()=>{o.remove(),s.innerText="Unsaved changes - make sure to save!",s.style.display="block",s.style.color="red",f()}),e==="mediaSources"?a.appendChild(o):e==="inAppEvents"&&c.appendChild(o),k()}function F(){L.forEach(e=>{r("mediaSources",e,"")}),S.forEach(e=>{r("inAppEvents",e,"")})}function N(){document.querySelectorAll(".mapping-row").forEach(e=>{e.remove()}),F(),f()}function H(){console.log("Loading existing mappings"),chrome.storage.sync.get(["mappings"],e=>{const n=e.mappings||[];n.length>0?(console.log("Saved mappings found:",n),n.forEach(t=>{r(t.section,t.original,t.newText)})):(console.log("No saved mappings found. Adding default mappings."),L.forEach(t=>{r("mediaSources",t,"")}),S.forEach(t=>{r("inAppEvents",t,"")}))})}const u=new T;let I=null;const g=document.getElementById("extensionStatusCheckbox");function V(){g.addEventListener("change",()=>{const t=g.checked;u.fireEvent("checkbox_change",{status:t?"checked":"unchecked"}),console.log("Analytics Event Fired: Checkbox Status Change")}),document.querySelectorAll(".image-option").forEach(t=>{t.addEventListener("click",()=>{const o=t.src;u.fireEvent("image_option_clicked",{imageSrc:o}),console.log("Analytics Event Fired: Image Option Clicked")})});const e=document.getElementById("customImageUrl");e.addEventListener("input",()=>{const t=e.value;u.fireEvent("custom_image_url_changed",{url:t}),console.log("Analytics Event Fired: Custom Image URL Changed")}),document.querySelectorAll(".preset-button").forEach(t=>{t.addEventListener("click",o=>{const a=o.target.id;I=a,u.fireEvent("vertical_preset_clicked",{buttonId:a}),console.log("Analytics Event Fired: Vertical Preset Clicked")})}),document.getElementById("save").addEventListener("click",()=>{I&&(u.fireEvent("vertical_preset_changed",{buttonId:I}),console.log("Analytics Event Fired: Vertical Preset Changed"))})}document.addEventListener("DOMContentLoaded",()=>{var t;console.log("DOM fully loaded and parsed");const e=document.getElementById("saveSection"),n=document.getElementById("restoreDefaults");chrome.storage.sync.get(["extensionEnabled"],o=>{o.extensionEnabled===void 0?(chrome.storage.sync.set({extensionEnabled:!0}),g.checked=!0):g.checked=o.extensionEnabled}),n.addEventListener("click",N),(t=e.parentNode)==null||t.insertBefore(s,e),window.addEventListener("load",()=>{u.firePageViewEvent(document.title,document.location.href),console.log("Analytics Event Fired: Page View")}),V(),H(),B(),k(),R()});
